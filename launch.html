<html>
<head>
<style>
.button {
  display: inline-block;
  padding: 15px 25px;
  font-size: 24px;
  cursor: pointer;
  text-align: center;
  text-decoration: none;
  outline: none;
  color: #fff;
  background-color: black;
  border: none;
  border-radius: 15px;
  box-shadow: 0 9px #999;
}

.button:hover {background-color: #871fff}

.button:active {
  background-color: black;
  box-shadow: 0 5px #666;
  transform: translateY(4px);
}
</style>
</head>
<body>
    <div style="text-align: center">
        <label style="font-size:3em"> Step 1</label><br/><br/>
        <button class="button" onclick="launchWindow()">Launch application</button>
        <br/><br/><br/><br/><br/>
        <label style="font-size:3em"> Step 2</label><br/><br/>
        <label style="font-size:1.5em">Invite other participants to join you</label><br/><br/>
        <label style="font-size:1.5em" id="urlholder"></label>
        <br/><br/><br/>
        Works only with <u>Chrome and Firefox</u>
    </div>
</body>
<script>
function getQueryStringValue (key) {  
  return decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]" + encodeURIComponent(key).replace(/[\.\+\*]/g, "\\$&") + "(?:\\=([^&]*))?)?.*$", "i"), "$1"));  
} 
    
function parseJwt (token) {
    var base64Url = token.split('.')[1];
    var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
    var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));

    return JSON.parse(jsonPayload);
};
var info = parseJwt(getQueryStringValue("ref"));
var url = window.location.protocol+"//"+window.location.hostname+"/opentok-spatial/?u="+info.userid;
document.getElementById("urlholder").innerHTML = url

function launchWindow(){
    var url = window.location.protocol+"//"+window.location.hostname+"/opentok-spatial/";
    window.open(url,"_new","fullscreen=yes,")
}
</script>
</html>